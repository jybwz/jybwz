# 需求分析文档

# 引言

## 1.1 编写目的  

 本文档将对《家园保卫战》策略游戏开发需求进行分析整理，通过资料查阅与其他同类游戏参考等方式，分析塔防卡牌策略类游戏的开发需求，对该游戏的各项内容进行文档规范，合理分配人力资源，使开发过程规范化、效率化。读者为游戏开发小组所有成员。

 该需求文档版本为1.0，对应游戏开发版本为Alpha 1.0。

## 1.2 背景说明

 策略游戏作为经久不衰的游戏类型，深受玩家们欢迎，在游戏表现上节奏较慢，给玩家充足的时间进行思考，在游戏内容上使玩家对每一步操作进行深度分析，而策略游戏中的塔防游戏加入战斗系统，让玩家拥有战斗的感觉，提高游戏的吸引程度。本游戏策略玩法方面借鉴植物大战僵尸的战斗模式，并结合其他玩法，降低游戏入门难度。

 本游戏同时以卡牌抽取模式为玩家提供战斗角色，相较于植物大战僵尸的自选植物模式，更添加随机性，避免游戏内容一成不变，也更要求玩家合理分配资源。

## 1.3 术语定义

- 场地格：游戏场地被划分为5\*7或6\*8或7\*9的正方形场地格，用以放置我方角色
- 场地等级：1级场地=5\*7场地，2级场地=6\*8场地，3级场地=7\*9场地；
- 抽卡：玩家花费金币抽取卡牌
- 招募：玩家花费金币选择卡牌槽内角色并使其进入场地

## 1.4 参考文献

# 任务概述

## 2.1 目标

 本游戏旨在开发一款卡牌塔防策略游戏，融合多种游戏元素，为玩家提供新颖的游戏体验。

## 2.2 用户特点

 本游戏玩家有一定的策略游戏经验，接触过植物大战僵尸等塔防游戏、阴阳师等卡牌游戏。

## 2.3 假定和约束

- 游戏开发周期为11周
- 玩家游玩过植物大战僵尸和阴阳师等游戏
- 游戏需实现该报告内所有需求

# 需求规定

## 3.1 对功能的规定

  游戏场地划分为场地格，场地格数随地图场景不同分为纵4横7、纵5横8、纵6横9三种，场地格具有特定属性，只允许相应属性的角色摆放。

  在游戏中，玩家通过花费金币、抽取卡牌随机获取作战角色，将角色点击后选择场地格进行摆放，与场地右侧产生的敌对角色进行战斗，如敌对角色通过任意一横路进入场地右侧，则视为游戏失败，若敌对角色全部死亡，则视为游戏胜利。

  玩家可以随时暂停、保存、退出游戏，并可以读取游戏存档。

## 3.2 对性能的需求

 本游戏在设计方面本着方便、实用及娱乐性高的宗旨，在对界面进行设计的过程中，始终坚持清晰明了，在性能方面能够实现效率高，不易出错等优点。游戏主界面应该力求美观，赏心悦目。游戏控制模块应做到易懂、易操作，而且准确率高，不易出错。

# 需求功能描述

## 4.1 塔防游戏元素

### 4.1.1 游戏场地

 游戏场地是所有角色交战的主要场所，也是玩家操作的主要位置

 以1级场地为例

![1级场地](/level1.png)
 场地被分为横向7格，纵向5格，共35个场地格，每一格最多可放置一名我方角色，其中黄色场地格仅可放置战斗职业（战士、射手、药剂师），绿色场地格可放置任意职业。敌对角色仅出现于黄色场地格，从右侧向左进攻，若敌对角色通过一条黄色横向到达场地最左侧，则视为游戏失败。

 为提升难度，2、3级场地中会随机产生灰色场地格，则该场地无法放置任何我方角色。为平衡难度，各级场地会随机产生红色场地格，当我方角色位于该场地格上时，该角色的各项属性将获得提升。

 针对对不同的关卡，会随机在场上放置预设的角色。

![2级场地](/level2.png)

<center>2级场地示意图</center>  

![3级场地](/level3.png)

<center>3级场地示意图</center>

###         4.1.2 己方角色

* 属性：外观、职业、等级、精神值、生命值、攻击力  
* 放置相同角色到同一场地格时会使该角色获得升级，各项能力小幅度提升  
* 当角色精神值降低至0时，将失去战斗能力，精神值可通过医疗师、天使进行恢复。
* 当角色生命值降低至0时，将死亡并无法复活，生命值可通过医疗师、天使进行恢复。
* 当玩家移除一名角色时，将返还  
$$\frac{当前精神值+当前生命值}{总精神值+总生命值} \times 角色花费$$
 例如，一名战士，总精神值100，总生命值100，当前精神值30，当前生命值80，则移除时返还金币  
$$\frac{30+80}{100+100} \times 20 = 11$$


| 职业 | 动作方式 | 动作范围 | 攻击力 | 精神值 | 生命值 | 招募花费 |
| --- | --- | --- | --- | --- | --- | --- |
| 战士 | 单体攻击 | 近 | 中 | 高 | 高 | 20 |
| 射手 | 单体攻击 | 远 | 高 | 低 | 低 | 15 |
| 药剂师 | 群体攻击 | 任意 | 中 | 高 | 低 | 30 |
| 医药师 | 单体治疗 | 任意 | 无 | 中 | 中 | 25 |
| 炼金师 | 产生金币 | 无 | 无 | 中 | 低 | 15 |

###         4.1.3 敌方角色

  属性：外观、种类、生命值、攻击力

| 种类 | 攻击方式 | 攻击范围 | 攻击力 | 移动速度 | 生命值 | 产生概率 | 死亡掉落金币 |
| --- | --- | --- | --- | --- | --- | --- | --- |
| 感染者(Infected) | 单体攻击 | 前方一格 | 中 | 中 | 较低 | 高 | 10 |
| 老鼠(Mouse) | 单体攻击 | 前方一格 | 低 | 快 | 低 | 较高 | 5 |
| 蝙蝠(Bat) | 单体攻击 | 任意场地 | 低 | 快 | 低 | 中 | 5 |
| 恐惧者(Dread)（单次） | 全体攻击 | 大幅降低精神值 | 无 | 无 | 无 | 较低 | 无 |
| 毒气者(Poisoner) | 范围攻击 | 降低附近4格角色生命值，无视精神值 | 很低 | 较慢 | 中 | 较低 | 15 |
| 巨异者(Giant) | 单体攻击 | 前方一格 | 高 | 较慢 | 高 | 低 | 50 |
| 瘟疫源(Plaguer) | 群体攻击 | 附近13格 | 中 | 慢 | 高 | 仅一次 | 逐步掉落 |

## 4.2 卡牌游戏元素

###         4.2.1 卡牌

 卡牌类型：角色卡、功能卡、事件卡

 卡牌属性：外观、卡牌名称、卡牌类型、花费、描述

- 角色卡：允许玩家进行角色招募
- 功能卡：一次性释放描述功能
- 事件卡：一次性产生描述事件

| 卡牌名称 | 卡牌类型 | 花费 | 概率 | 描述 |
| --- | --- | --- | --- | --- |
| 招募战士 | 角色卡 | 20 | 高 | 招募一名战士战斗 |
| 招募射手 | 角色卡 | 15 | 高 | 招募一名射手战斗 |
| 招募药剂师 | 角色卡 | 30 | 高 | 招募一名药剂师战斗 |
| 招募医药师 | 角色卡 | 25 | 高 | 招募一名医药师 |
| 招募炼金师 | 角色卡 | 15 | 高 | 招募一名炼金师 |
| 转变 | 功能卡 |   | 较低 | 随机改变一名角色的职业 |
| 升级 | 功能卡 |   | 中 | 使一名角色获得一次升级 |
| 移除 | 功能卡 |   | 较低 | 移除一名角色并返还所有花费 |
| 精神恢复 | 功能卡 |   | 中 | 使一名角色一次性恢复所有精神值 |
| 生命恢复 | 功能卡 |   | 中 | 使一名角色一次性恢复所有生命值 |
| 恢复 | 功能卡 |   | 较低 | 使一名角色一次性恢复所有精神值和生命值 |
| 范围恢复 | 功能卡 |   | 低 | 使多名角色一次性恢复所有精神值和生命值 |
| 持续恢复 | 功能卡 |   | 较低 | 使一名角色持续恢复精神值和生命值 |
| 范围持续恢复 | 功能卡 |   | 低 | 使多名角色持续恢复精神值和生命值 |
| 坚韧不屈 | 功能卡 |   | 低 | 永久使一名角色在无精神值状态下继续战斗 |
| 天使降临 | 事件卡 |   | 低 | 恢复所有角色所有精神值和生命值 |
| 复苏之风 | 事件卡 |   | 中 | 持续恢复所有角色精神值和生命值 |
| 时间静止 | 事件卡 |   | 较低 | 使所有敌方角色停止移动和攻击 |
| 恶魔退散 | 事件卡 |   | 低 | 将所有敌方角色移动至场地右侧 |

###         4.2.2 金币

  金币是击杀怪物掉落或炼金师产生，拥有来抽取卡牌、招募角色等功能。

###         4.2.3 抽卡

  玩家花费一定金币抽取一张卡牌，可选择存入卡牌槽或放回并返还一半金币。

  花费金币数量随地图等级不同、游戏时间的长度、抽卡次数等因素变化

###         4.2.4 卡牌槽

  玩家选择一张抽取的卡牌后将放入卡牌槽，卡牌槽上限根据地图等级不同而变化，玩家可随时选择卡牌槽内角色进行招募，也可以将卡牌移除，返还抽卡时金币的一半。

###         4.2.5 招募

  玩家花费金币从卡牌槽选择角色进行招募，并放置在场地格上，不同角色无法放置，相同角色将使其等级获得提升。

###         4.2.6 随机性

  当玩家抽卡时，产生的卡牌是随机的，但会随着场上与卡牌槽内角色数量而变化，即数量越多的角色，其产生几率将降低，未出现过的角色概率将提高。

## 4.3 游戏流程图
![游戏流程图](/流程图.png)

## 4.4 UML图
### 4.4.1 角色UML图
![角色UML图](/角色UML.png)
### 4.4.2 卡牌UML图
![卡牌UML图](/卡牌UML.png)
## 4.5 UI界面

###         4.5.1 加载界面

  加载界面需有进度条、背景图片

###         4.5.2 欢迎界面

  欢迎界面有三个按钮：开始游戏、载入游戏、图鉴、退出

###         4.5.3 关卡选择界面

  关卡分为场景与关卡，左侧按钮进行场景选择，右侧显示该场景内关卡

  场景分为村庄、城镇、城市，难度依次递增，游戏内场景据此改变。

###         4.5.2 游戏内界面（未定）

![界面](/界面.png)
# 运行环境规定

##         1.配置要求

 操作系统 Windows XP、Vista、Win7、Win10，32位。CPU 主频1.4 GHz及以上。内存 1 G及以上。独立显卡或集成显卡，要求显存512MB以上。硬盘大小 512MB以上。屏幕分辨率800\*600及以上。
